<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Produtos</title>
  <link rel="stylesheet" href="/css/style.css">
  <style>
    /* Extra: Carrossel horizontal customizado */
    .carousel-section {
      margin: 2.5rem 0 1.5rem 0;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.06);
      padding: 2rem 0 2rem 0;
    }
    .carousel-title {
      color: #e67e22;
      font-size: 1.4rem;
      font-weight: bold;
      margin-bottom: 1.2rem;
      padding-left: 2rem;
    }
    .carousel-container {
      display: flex;
      align-items: center;
      position: relative;
    }
    .carousel-arrow {
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1.4rem;
      cursor: pointer;
      margin: 0 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.07);
      z-index: 2;
      transition: background 0.18s;
    }
    .carousel-arrow:active { background: #5a3d8a; }
    .carousel-track {
      display: flex;
      overflow-x: auto;
      scroll-behavior: smooth;
      padding-bottom: 1rem;
      gap: 1.5rem;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }
    .carousel-track::-webkit-scrollbar { display: none; }
    .carousel-card {
      min-width: 220px;
      max-width: 220px;
      background: #fef5e7;
      border-radius: 8px;
      box-shadow: var(--shadow);
      padding: 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.2s, transform 0.2s;
      cursor: pointer;
    }
    .carousel-card:hover { box-shadow: var(--shadow-hover); transform: translateY(-5px);}
    .carousel-img {
      width: 140px; height: 140px; object-fit: cover; border-radius: 6px; background: #eee;
      margin-bottom: 1rem;
    }
    .carousel-prod-title {
      font-weight: 700;
      font-size: 1.08rem;
      margin-bottom: 0.3rem;
      color: var(--dark-color);
      text-align: center;
    }
    .carousel-prod-preco {
      font-size: 1.13rem;
      color: #e67e22;
      font-weight: bold;
      margin-top: 0.5rem;
    }
    .carousel-prod-estoque {
      font-size: 0.88rem;
      color: var(--gray-color);
    }

    /* Grid vertical */
    .section-title {
      margin: 2.5rem 0 1.5rem 0;
      font-size: 1.3rem;
      font-weight: bold;
      color: #e67e22;
      text-align: center;
      letter-spacing: 0.04em;
    }
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 2rem;
      margin-bottom: 2.5rem;
    }
    .product-card {
      background: #fff;
      border-radius: 8px;
      box-shadow: var(--shadow);
      display: flex;
      flex-direction: column;
      transition: box-shadow 0.2s, transform 0.2s;
      overflow: hidden;
      position: relative;
      padding-bottom: 1rem;
      cursor: pointer;
    }
    .product-card:hover { box-shadow: var(--shadow-hover); transform: translateY(-5px);}
    .product-img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      background: #eee;
      border-radius: 0 0 8px 8px;
    }
    .product-content {
      padding: 1.1rem 1rem 0.5rem 1rem;
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .product-title {
      font-size: 1.08rem;
      font-weight: 700;
      color: var(--dark-color);
      margin-bottom: 0.5rem;
      text-align: left;
    }
    .product-preco {
      color: #e67e22;
      font-size: 1.1rem;
      font-weight: bold;
      margin-top: 0.7rem;
    }
    .product-estoque {
      color: var(--gray-color);
      font-size: 0.93rem;
      margin-top: 0.3rem;
    }
    /* Responsivo */
    @media (max-width: 700px) {
      .carousel-card, .product-card { min-width: 160px; max-width: 100%; }
      .carousel-img, .product-img { height: 100px; width: 100px; }
      .product-img { height: 120px;}
      .carousel-img { margin-bottom: 0.7rem;}
      .carousel-title, .section-title { font-size: 1.1rem; }
      .carousel-section, .section-title { padding-left: 1rem;}
      .product-content { padding: 0.7rem 0.5rem;}
    }
    @media (max-width: 500px) {
      .carousel-title, .section-title { padding-left: 0.5rem;}
      .product-img, .carousel-img { height: 70px; width: 70px; }
    }
  </style>
</head>
<body>
  <header class="main-header">
    <div class="container">
      <h1 style="text-align:center;">Produtos</h1>
    </div>
  </header>

  <!-- Barra de pesquisa -->
  <div class="container" style="margin-top: 1.2rem; margin-bottom: 1.5rem;">
    <form action="/produtos" method="get" style="display:flex; max-width:500px; margin:auto;">
      <input
        type="text"
        name="q"
        value="<%= typeof q !== 'undefined' ? q : '' %>"
        placeholder="Buscar produtos..."
        style="flex:1; padding:0.7rem 1rem; border-radius:8px 0 0 8px; border:1px solid #e0e0e0; font-size:1.08rem; border-right:0;"
        autofocus
      />
      <button type="submit" style="background:var(--primary-color); color:#fff; border:none; border-radius:0 8px 8px 0; padding:0 1.3rem; font-size:1.08rem; cursor:pointer;">
        &#128269;
      </button>
    </form>
  </div>

  <main class="container">

    <!-- Carrossel horizontal -->
    <section class="carousel-section">
      <div class="carousel-title">DESTAQUES PARA VOCÊ</div>
      <div class="carousel-container">
        <button class="carousel-arrow" onclick="slideCarousel(-1)">&#10094;</button>
        <div class="carousel-track" id="carouselTrack">
          <% let destaques = produtos.slice(0, 8); %>
          <% if (destaques.length === 0) { %>
            <div style="padding:2rem;color:#999;">Nenhum produto em destaque.</div>
          <% } %>
          <% destaques.forEach(produto => { %>
            <div class="carousel-card">
              <% if (produto.imagens && produto.imagens[0]) { %>
                <img src="<%= produto.imagens[0] %>" alt="Produto" class="carousel-img">
              <% } else { %>
                <div class="carousel-img" style="background:#eee;display:flex;align-items:center;justify-content:center;color:#bbb;">Sem imagem</div>
              <% } %>
              <div class="carousel-prod-title"><%= produto.nome %></div>
              <div class="carousel-prod-preco">R$ <%= produto.preco ? produto.preco.toFixed(2) : "0.00" %></div>
              <div class="carousel-prod-estoque">Estoque: <%= produto.estoque %></div>
            </div>
          <% }); %>
        </div>
        <button class="carousel-arrow" onclick="slideCarousel(1)">&#10095;</button>
      </div>
    </section>

    <!-- Grid vertical -->
    <section>
      <div class="section-title">DESCOBERTAS DO DIA</div>
      <div class="product-grid">
        <% if (produtos.length === 0) { %>
          <div style="padding:2rem;color:#999;">Nenhum produto disponível.</div>
        <% } else { %>
          <% produtos.forEach(produto => { %>
            <div class="product-card">
              <% if (produto.imagens && produto.imagens[0]) { %>
                <img src="<%= produto.imagens[0] %>" alt="Produto" class="product-img">
              <% } else { %>
                <div class="product-img" style="background:#eee;display:flex;align-items:center;justify-content:center;color:#bbb;">Sem imagem</div>
              <% } %>
              <div class="product-content">
                <div class="product-title"><%= produto.nome %></div>
                <div class="product-preco">R$ <%= produto.preco ? produto.preco.toFixed(2) : "0.00" %></div>
                <div class="product-estoque">Estoque: <%= produto.estoque %></div>
              </div>
            </div>
          <% }); %>
        <% } %>
      </div>
    </section>

  </main>

  <footer class="main-footer">
    &copy; <%= new Date().getFullYear() %> Meu E-commerce Moderno
  </footer>

  <script>
    // Carrossel horizontal (simples)
    function slideCarousel(dir) {
      const el = document.getElementById('carouselTrack');
      const card = el.querySelector('.carousel-card');
      if (!card) return;
      const scrollAmount = card.offsetWidth + 24; // largura + gap
      el.scrollBy({ left: dir * scrollAmount * 2, behavior: 'smooth' });
    }
  </script>
</body>
</html>
